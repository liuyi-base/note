# 一，shell介绍

## 1.1、前沿介绍

linux内置了许多shell解释器，可用cat /etc/shell查看

默认引擎是 /bin/bash，可用echo $SHELL查看

如果shell命令没有给出明确路径，linux会到默认路径下去查，路径echo $PATH可以查询

接收用户命令，发送给操作系统内核执行

![image-20220414150900356](../../images/image-20220414150900356.png)

# 二、编写脚本

## 2.1、基本准备

1. 脚本以#!/bin/bash 开头

2. 执行

   bash/sh 路径

   chomd 744 文件，然后./文件名或source/文件名

## 2.2、语法

### 2.2.1、变量

#### 2.2.1.1、定义变量

2. 定义变量：变量=值 
3. 撤销变量：unset 变量 
4. 声明静态变量：readonly 变量，注意：不能 unset
5. 升级为全局变量：export name
6. source /etc/profile，使文件生效，没有新建子shell
7. 父子shell，子shell无法影响父shell，父shell全局变量会影响子shell

#### 2.2.1.2、将命令的返回值赋给变量

1）

```
A=`ls -la`
```

 **反引号**，运行里面的命令，并把结果返回给变量 A 

2）A=$(ls -la) 等价于反引号

### 2.2.2、参数

```
$n,（0代表命令本身，超过10的字符，需要用${n}
$#:参数个数
$*：所有参数，整体
$@:所有参数，组成的集合
$$：当前进程的进程号（PID）
$!：后台运行的最后一个进程的进程号（PID）
$？退出状态，或函数的返回值。如果这个变量的值为 0，证明上一个命令正确执行；如果这个变量的值为非 0（具体是哪个数，由命令自己来决定），则证明上一个命令 执行不正确了。退出状态，或函数的返回值。
0代表true
1代表false
```

### 2.2.3、运算符

```
expr + -  \* / % 加减乘除余，注意，参数，符号一定要加空格，乘不是*。而是\*
$[运算式]
$((运算式))
$[$A+$B]:两个参数的和
-a:与
-o:或
!：非
```

#### 2.2.3.1、算数运算符

```
+、-、*、/、%、=、==、!=
```

#### 2.2.3.2、数字关系运算符

```
-eq,-nq,-gt,-lt,-ge,-le
```

#### 2.2.3.3、布尔运算符

```
！，-o，-a
```

#### 2.2.3.4、逻辑运算符

```
&&,||
```

#### 2.2.3.5、字符串运算符

```
=，!=，-z，-n，$
```

#### 2.2.3.6、文件运算符

```
-r 有读的权限 [ -r 文件 ] 
-w 有写的权限 
-x 有执行的权限 
-f 文件存在并且是一个常规的文件 
-e 文件存在 
-d 文件存在并是一个目录
-nt a文件是否比b文件新
-ot a文件是否比b文件旧
-ef a文件和b文件是否是同一个（原理是硬连接，所以软连接无效）
-z 判断文件是否为空
-n 判断文件是否为非空
```



### 2.2.4、条件判断

```
test condition 然后 $?  0代表true，其他false
或者
[ condition ] 一定要空格，包括condition本身表达式也需要空格，否则会把condition当成表达式
```

判断：

```
 = 字符串比较 
!= 不等于
-lt 小于 
-le 小于等于 
-eq 等于 
-gt 大于 
-ge 大于等于
-ne 不等于
```

连接：

```
a && b:a如果是正确的的，执行b
a || b:a如果不是正确的，执行b
[ $a = 2 ] && echo "true" || echo "false"
```

### 2.2.5、if判断

```
then fi代替了java中的{}
else
elif
then
```

### 2.2.6、switch case

```
case $@ in
"值1"）
 程序
 ;;
 。。。。。。
 *）
 ;;
 esac
```

### 2.2.7、for循环

```
for 变量 in 值 1 值 2 值 3… 
do
程序 
done
```

### 2.2.8、while

```
while [ 条件判断式 ] 
do
程序
done
```

###  2.2.9、 读控制台

```
read -t num -p “提示话” name
-t:指定等待时间
-s:用户输入内容隐藏
-n：字符限制
-p：提示语
```

## 三、执行

1. 路径+.sh文件（绝对路径，相对路径都行）

   ```
   ./a.sh. ||  /temp/a.sh，会新建子bash，并且不继承父bash中除export之外的所有变量
   ```

2. sh + .sh文件

   ```
   会在sh版解释器中新建子bash
   ```

3. . +sh文件 或者 source +sh文件

   ```
   不会新建子bash，所以会继承当前bash中所有变量，它生成的变量也会影响当前环境
   ```

   

## 四、命令积累

```
ping -c num 网址：判断能否ping同某一个网址
pgrep 进程名字：判断进程是否存在
wget/curl 网址：判断一个服务是否能够访问

```

