# 1、秒杀设计

## 1.1、降低链条压力

### 1.1.1、服务单一职责独立部署

秒杀服务即使自己扛不住压力，挂掉。 不要影响别人 

### 1.1.2、恶意请求拦截

秒杀链接加密、令牌识别、防止恶意攻击，模拟秒杀请求，1000次/s攻击。 防止链接暴露，自己工作人员，提前秒杀商品。 

### 1.1.3、限流熔断降级

前端限流+后端限流限制次数，限制总量，快速失败降级运行，熔断隔离防止雪崩 

### 1.1.4、流量错峰 

使用各种手段，将流量分担到更大宽度的时 间点。比如验证码，加入购物车 

## 1.2、缓存

### 1.2.1、动静分离

nginx做好动静分离。保证秒杀和商品详情页的动态请求才打到后端的服务集群。 使用CDN网络，分担本集群压力

### 1.2.2、redis库存预热、信号量控制

秒杀读多写少。无需每次实时校验库存。我们库存预热，放到redis中。信号量控制进 来秒杀的请求 

## 1.3、队列削峰

### 1.3.1、apache druid 实时分析数据

 前端访问时候，lua脚本记录日志，发送kafka，druid分析kafka消息，判断热门商品。

### 1.3.2、队列排队

1万个商品，每个1000件秒杀。双11 所有秒杀成功的请求，进入队列，慢慢创建订单，扣减库存即可。



